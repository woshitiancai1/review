## C语言指针

http://c.biancheng.net/c/80/

指针是内存的地址，指针变量是保存了内存地址的变量，也就是存放指针。

#### 概念

计算机中所有数据必须放在内存中，不同类型的数据占用的字节数不一样。int (4); char (1);

为每个字节编上号码，每个字节的编号是惟一的。

将内存中字节的编号成为地址或指针, `&`来获得地址， 字符串不用



#### 定义和使用

###### 定义：

定义指针变量与定义普通变量类似，不过要在变量名前面加 `*` 号

```c
datatype *name;
// 或
datatype *name = value;
```

`*`是一个特殊符号，表明一个变量是指针变量，`datatype`表示该指针变量所指向的数据的类型

```c
int a = 100;
int *p_a = &a;
//定义p_a的同时对它进行了初始化，将变量a的地址赋予它，此时p_a指向a。
//要注意，p_a需要的是一个地址，所以a前面要加取地址符&
```

定义指针变量时必须带上`*`，给指针变量赋值时不能带`*`

```c
//定义普通变量
float a = 99.5, b = 10.6;
char c = '@', d = '#';
//定义指针变量
float *p1 = &a;
char *p2 = &c;
//修改指针变量的值
p1 = &b;
p2 = &d;
```

###### 通过指针变量取得数据

指针变量存储了数据的地址，通过指针变量能过获得**该地址上的数据**，格式：`*pointer`

`*`称为`指针运算符`，用来取得某个地址上的数据。

```c
int a = 15;
int *p = &a;
printf("%d, %d\n", a, *p);  //两种方式都可以输出a的值  15  15
//假设 a 的地址是 0X1000，p 指向 a 后，p 本身的值也会变为 0X1000，
//*p 表示获取地址 0X1000 上的数据，也即变量 a 的值。从运行结果看，*p 和 a 是等价的。

//其实普通变量和指针变量都是地址的助记符，虽然通过 *p 和 a 获取到的数据一样，
//但它们的运行过程稍有不同，
//a只需要一次运算就能够取得数据， *p要经过两次运算 
//指针是间接获取数据，使用变量名是直接获取数据，前者比后者代价要高
```

![1_01](../img/1_01.jpg)

指针除了可以获取内存上数据，也可以修改内存上数据：

```c
int a = 15, b = 99, c = 222;
int *p = &a;  //定义指针变量
*p = b;  //通过指针变量修改内存上的数据
c = *p;  //通过指针变量获取内存上的数据
printf("%d, %d, %d, %d\n", a, b, c, *p);// 99,99,99,99
//*p 代表的是 a 中的数据，它等价于 a
```

###### *

`*`在不同的场景下有不同的作用：`*`可以用在指针变量的定义中，表明这是一个指针变量，以和普通变量区分开；使用指针变量时在前面加`*`表示获取指针指向的数据，或者说表示的是指针指向的数据本身。

###### 关于 * 和 &

假设有一个 int 类型的变量 a，pa 是指向它的指针。

`*&a`: 等价于a。

`*&a`可以理解为`*(&a)`，`&a`表示取变量 a 的地址（等价于 `pa`），`*(&a)`表示取这个地址上的数据（等价于 `*pa`），绕来绕去，又回到了原点，`*&a`仍然等价于 a。

`&*pa`:等价于pa。

`&*pa`可以理解为`&(*pa)`，`*pa`表示取得 pa 指向的数据（等价于 a），`&(*pa)`表示数据的地址（等价于 `&a`），所以`&*pa`等价于 pa。

###### 星号* 三种用途

- 表示乘法，例如`int a = 3, b = 5, c;  c = a * b;`    这是最容易理解的。
- 表示定义一个指针变量，以和普通变量区分开，例如`int a = 100;  int *p = &a;`。
- 表示获取指针指向的数据，是一种间接操作，例如`int a, b, *p = &a;  *p = 100;  b = *p;`